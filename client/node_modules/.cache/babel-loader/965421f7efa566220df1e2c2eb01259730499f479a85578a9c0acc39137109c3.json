{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\vaibh\\\\chat-app\\\\Chat App\\\\client\\\\src\\\\modules\\\\Dashboard\\\\index.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useRef, useState } from 'react';\nimport chat from '../../assets/chat.png';\nimport Input from '../../components/Input';\nimport { io } from 'socket.io-client';\nimport Button from '../../components/Button';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Dashboard = () => {\n  _s();\n  var _messages$receiver3, _messages$receiver4, _messages$receiver5, _messages$receiver6, _messages$receiver7;\n  const [user, setUser] = useState(JSON.parse(localStorage.getItem('user:detail')));\n  const [conversations, setConversations] = useState([]);\n  const [messages, setMessages] = useState([]);\n  const [message, setMessage] = useState('');\n  const [users, setUsers] = useState([]);\n  const [socket, setSocket] = useState(null);\n  const messageRef = useRef(null);\n  useEffect(() => {\n    const loggedInUser = JSON.parse(localStorage.getItem('user:detail'));\n\n    // Initialize socket connection\n    const newSocket = io('http://localhost:8080');\n    setSocket(newSocket);\n\n    // Cleanup socket on component unmount\n    return () => {\n      newSocket.disconnect();\n    };\n  }, []);\n  useEffect(() => {\n    if (!socket) return;\n\n    // Emit addUser event when socket is connected\n    socket.emit('addUser', user === null || user === void 0 ? void 0 : user.id);\n\n    // Listen for incoming messages\n    socket.on('getMessage', data => {\n      setMessages(prevMessages => [...prevMessages, {\n        user: data.user,\n        message: data.message\n      }]);\n    });\n\n    // Clean up event listeners on component unmount or socket change\n    return () => {\n      socket.off('getMessage');\n    };\n  }, [socket, user === null || user === void 0 ? void 0 : user.id]);\n  useEffect(() => {\n    const loggedInUser = JSON.parse(localStorage.getItem('user:detail'));\n\n    // Fetch conversations for logged in user\n    const fetchConversations = async () => {\n      try {\n        const res = await fetch(`http://localhost:8000/api/conversations/${loggedInUser === null || loggedInUser === void 0 ? void 0 : loggedInUser.id}`, {\n          method: 'GET',\n          headers: {\n            'Content-Type': 'application/json'\n          }\n        });\n        if (res.ok) {\n          const resData = await res.json();\n          setConversations(resData);\n        } else {\n          console.error('Failed to fetch conversations:', await res.text());\n        }\n      } catch (error) {\n        console.error('Error fetching conversations:', error);\n      }\n    };\n    fetchConversations();\n  }, []);\n  useEffect(() => {\n    const fetchUsers = async () => {\n      try {\n        const res = await fetch(`http://localhost:8000/api/users/${user === null || user === void 0 ? void 0 : user.id}`, {\n          method: 'GET',\n          headers: {\n            'Content-Type': 'application/json'\n          }\n        });\n        if (res.ok) {\n          const resData = await res.json();\n          setUsers(resData);\n        } else {\n          console.error('Failed to fetch users:', await res.text());\n        }\n      } catch (error) {\n        console.error('Error fetching users:', error);\n      }\n    };\n    fetchUsers();\n  }, [user === null || user === void 0 ? void 0 : user.id]);\n  const fetchMessages = async (conversationId, receiver) => {\n    try {\n      const res = await fetch(`http://localhost:8000/api/message/${conversationId}?senderId=${user === null || user === void 0 ? void 0 : user.id}&&receiverId=${receiver === null || receiver === void 0 ? void 0 : receiver.receiverId}`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      if (res.ok) {\n        const resData = await res.json();\n        setMessages(resData);\n      } else {\n        console.error('Failed to fetch messages:', await res.text());\n      }\n    } catch (error) {\n      console.error('Error fetching messages:', error);\n    }\n  };\n  const sendMessage = async () => {\n    try {\n      var _messages$receiver, _messages$receiver2;\n      socket === null || socket === void 0 ? void 0 : socket.emit('sendMessage', {\n        senderId: user === null || user === void 0 ? void 0 : user.id,\n        receiverId: messages === null || messages === void 0 ? void 0 : (_messages$receiver = messages.receiver) === null || _messages$receiver === void 0 ? void 0 : _messages$receiver.receiverId,\n        message,\n        conversationId: messages === null || messages === void 0 ? void 0 : messages.conversationId\n      });\n      const res = await fetch(`http://localhost:8000/api/message`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          conversationId: messages === null || messages === void 0 ? void 0 : messages.conversationId,\n          senderId: user === null || user === void 0 ? void 0 : user.id,\n          message,\n          receiverId: messages === null || messages === void 0 ? void 0 : (_messages$receiver2 = messages.receiver) === null || _messages$receiver2 === void 0 ? void 0 : _messages$receiver2.receiverId\n        })\n      });\n      if (res.ok) {\n        setMessage(''); // Clear message input on successful send\n      } else {\n        console.error('Failed to send message:', await res.text());\n      }\n    } catch (error) {\n      console.error('Error sending message:', error);\n    }\n  };\n  const handleLogout = async () => {\n    try {\n      const token = localStorage.getItem('user:token');\n      const response = await fetch('http://localhost:8000/api/logout', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      if (response.ok) {\n        localStorage.removeItem('user:token');\n        window.location.href = '/users/sign_in';\n      } else {\n        console.log('Logout failed:', await response.text());\n      }\n    } catch (error) {\n      console.error('Logout error:', error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"w-screen flex\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-[25%] h-screen bg-secondary overflow-scroll\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center my-8 mx-14\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: chat,\n            width: 75,\n            height: 75,\n            className: \"border border-primary p-[2px] rounded-full\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 174,\n            columnNumber: 26\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ml-8\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-2xl\",\n            children: user === null || user === void 0 ? void 0 : user.fullName\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 176,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-lg font-light\",\n            children: \"My Account\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 177,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-center my-8\",\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleLogout,\n          children: \"Logout\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mx-14 mt-10\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-primary text-lg\",\n          children: \"Messages\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: conversations.length > 0 ? conversations.map(_ref => {\n            let {\n              conversationId,\n              user\n            } = _ref;\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center py-8 border-b border-b-gray-300\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"cursor-pointer flex items-center\",\n                onClick: () => fetchMessages(conversationId, user),\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: /*#__PURE__*/_jsxDEV(\"img\", {\n                    src: chat,\n                    className: \"w-[60px] h-[60px] rounded-full p-[2px] border border-primary\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 192,\n                    columnNumber: 50\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 192,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"ml-6\",\n                  children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                    className: \"text-lg font-semibold\",\n                    children: user === null || user === void 0 ? void 0 : user.fullName\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 194,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-sm font-light text-gray-600\",\n                    children: user === null || user === void 0 ? void 0 : user.email\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 195,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 193,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 191,\n                columnNumber: 41\n              }, this)\n            }, conversationId, false, {\n              fileName: _jsxFileName,\n              lineNumber: 190,\n              columnNumber: 37\n            }, this);\n          }) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-center text-lg font-semibold mt-24\",\n            children: \"No Conversations\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 38\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-[50%] h-screen bg-white flex flex-col items-center\",\n      children: [(messages === null || messages === void 0 ? void 0 : (_messages$receiver3 = messages.receiver) === null || _messages$receiver3 === void 0 ? void 0 : _messages$receiver3.fullName) && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-[75%] bg-secondary h-[80px] my-14 rounded-full flex items-center px-14 py-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: chat,\n            width: 60,\n            height: 60,\n            className: \"rounded-full\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 30\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ml-6 mr-auto\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg\",\n            children: messages === null || messages === void 0 ? void 0 : (_messages$receiver4 = messages.receiver) === null || _messages$receiver4 === void 0 ? void 0 : _messages$receiver4.fullName\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 211,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm font-light text-gray-600\",\n            children: messages === null || messages === void 0 ? void 0 : (_messages$receiver5 = messages.receiver) === null || _messages$receiver5 === void 0 ? void 0 : _messages$receiver5.email\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"h-[75%] w-full overflow-scroll shadow-sm\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-14\",\n          children: (messages === null || messages === void 0 ? void 0 : messages.length) > 0 ? messages.map((_ref2, index) => {\n            let {\n              message,\n              user: {\n                id\n              } = {}\n            } = _ref2;\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `max-w-[40%] rounded-b-xl p-4 mb-6 ${id === (user === null || user === void 0 ? void 0 : user.id) ? 'bg-primary text-white rounded-tl-xl ml-auto' : 'bg-secondary rounded-tr-xl'} `,\n              children: message\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 221,\n              columnNumber: 37\n            }, this);\n          }) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-center text-lg font-semibold mt-24\",\n            children: \"No Messages or No Conversation Selected\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 222,\n            columnNumber: 38\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: messageRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 17\n      }, this), messages !== null && messages !== void 0 && (_messages$receiver6 = messages.receiver) !== null && _messages$receiver6 !== void 0 && _messages$receiver6.fullName ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-14 w-full flex items-center\",\n        children: [/*#__PURE__*/_jsxDEV(Input, {\n          placeholder: \"Type a message...\",\n          value: message,\n          onChange: e => setMessage(e.target.value),\n          className: \"w-[75%]\",\n          inputClassName: \"p-4 border-0 shadow-md rounded-full bg-light focus:ring-0 focus:border-0 outline-none\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `ml-4 p-2 cursor-pointer bg-light rounded-full ${!message && 'pointer-events-none'}`,\n          onClick: sendMessage,\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            xmlns: \"http://www.w3.org/2000/svg\",\n            className: \"icon icon-tabler icon-tabler-send\",\n            width: \"30\",\n            height: \"30\",\n            viewBox: \"0 0 24 24\",\n            strokeWidth: \"1.5\",\n            stroke: \"#2c3e50\",\n            fill: \"none\",\n            strokeLinecap: \"round\",\n            strokeLinejoin: \"round\",\n            children: [/*#__PURE__*/_jsxDEV(\"path\", {\n              stroke: \"none\",\n              d: \"M0 0h24v24H0z\",\n              fill: \"none\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 233,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n              x1: \"10\",\n              y1: \"14\",\n              x2: \"21\",\n              y2: \"3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 234,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n              d: \"M21 3l-6.5 18a0.55 .55 0 0 1 -1.1 0l-3.5 -9.5h-7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 235,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 21\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `ml-4 p-2 cursor-pointer bg-light rounded-full ${!message && 'pointer-events-none'}`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 30\n      }, this), !(messages !== null && messages !== void 0 && (_messages$receiver7 = messages.receiver) !== null && _messages$receiver7 !== void 0 && _messages$receiver7.fullName) && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-14 w-full flex items-center justify-center\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-lg text-gray-600\",\n          children: \"Select a conversation to start messaging\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-[25%] h-screen bg-light px-8 py-16 overflow-scroll\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-primary text-lg\",\n        children: \"People\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: users.length > 0 ? users.map(_ref3 => {\n          let {\n            userId,\n            user\n          } = _ref3;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center py-8 border-b border-b-gray-300\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"cursor-pointer flex items-center\",\n              onClick: () => fetchMessages('new', user),\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: chat,\n                  className: \"w-[60px] h-[60px] rounded-full p-[2px] border border-primary\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 259,\n                  columnNumber: 46\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 259,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"ml-6\",\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"text-lg font-semibold\",\n                  children: user === null || user === void 0 ? void 0 : user.fullName\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 261,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm font-light text-gray-600\",\n                  children: user === null || user === void 0 ? void 0 : user.email\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 262,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 260,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 258,\n              columnNumber: 37\n            }, this)\n          }, userId, false, {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 33\n          }, this);\n        }) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-center text-lg font-semibold mt-24\",\n          children: \"No Conversations\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 34\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 171,\n    columnNumber: 9\n  }, this);\n};\n_s(Dashboard, \"/IMyGg5Md2PLlYwVJ4wK1QS28mE=\");\n_c = Dashboard;\nexport default Dashboard;\nvar _c;\n$RefreshReg$(_c, \"Dashboard\");","map":{"version":3,"names":["useEffect","useRef","useState","chat","Input","io","Button","jsxDEV","_jsxDEV","Dashboard","_s","_messages$receiver3","_messages$receiver4","_messages$receiver5","_messages$receiver6","_messages$receiver7","user","setUser","JSON","parse","localStorage","getItem","conversations","setConversations","messages","setMessages","message","setMessage","users","setUsers","socket","setSocket","messageRef","loggedInUser","newSocket","disconnect","emit","id","on","data","prevMessages","off","fetchConversations","res","fetch","method","headers","ok","resData","json","console","error","text","fetchUsers","fetchMessages","conversationId","receiver","receiverId","sendMessage","_messages$receiver","_messages$receiver2","senderId","body","stringify","handleLogout","token","response","removeItem","window","location","href","log","className","children","src","width","height","fileName","_jsxFileName","lineNumber","columnNumber","fullName","onClick","length","map","_ref","email","_ref2","index","ref","placeholder","value","onChange","e","target","inputClassName","xmlns","viewBox","strokeWidth","stroke","fill","strokeLinecap","strokeLinejoin","d","x1","y1","x2","y2","_ref3","userId","_c","$RefreshReg$"],"sources":["C:/Users/vaibh/chat-app/Chat App/client/src/modules/Dashboard/index.js"],"sourcesContent":["import { useEffect, useRef, useState } from 'react';\r\nimport chat from '../../assets/chat.png';\r\nimport Input from '../../components/Input';\r\nimport { io } from 'socket.io-client';\r\nimport Button from '../../components/Button';\r\n\r\nconst Dashboard = () => {\r\n    const [user, setUser] = useState(JSON.parse(localStorage.getItem('user:detail')));\r\n    const [conversations, setConversations] = useState([]);\r\n    const [messages, setMessages] = useState([]);\r\n    const [message, setMessage] = useState('');\r\n    const [users, setUsers] = useState([]);\r\n    const [socket, setSocket] = useState(null);\r\n    const messageRef = useRef(null);\r\n\r\n    useEffect(() => {\r\n        const loggedInUser = JSON.parse(localStorage.getItem('user:detail'));\r\n\r\n        // Initialize socket connection\r\n        const newSocket = io('http://localhost:8080');\r\n        setSocket(newSocket);\r\n\r\n        // Cleanup socket on component unmount\r\n        return () => {\r\n            newSocket.disconnect();\r\n        };\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (!socket) return;\r\n\r\n        // Emit addUser event when socket is connected\r\n        socket.emit('addUser', user?.id);\r\n\r\n        // Listen for incoming messages\r\n        socket.on('getMessage', data => {\r\n            setMessages(prevMessages => [\r\n                ...prevMessages,\r\n                { user: data.user, message: data.message }\r\n            ]);\r\n        });\r\n\r\n        // Clean up event listeners on component unmount or socket change\r\n        return () => {\r\n            socket.off('getMessage');\r\n        };\r\n    }, [socket, user?.id]);\r\n\r\n    useEffect(() => {\r\n        const loggedInUser = JSON.parse(localStorage.getItem('user:detail'));\r\n\r\n        // Fetch conversations for logged in user\r\n        const fetchConversations = async () => {\r\n            try {\r\n                const res = await fetch(`http://localhost:8000/api/conversations/${loggedInUser?.id}`, {\r\n                    method: 'GET',\r\n                    headers: {\r\n                        'Content-Type': 'application/json',\r\n                    }\r\n                });\r\n                if (res.ok) {\r\n                    const resData = await res.json();\r\n                    setConversations(resData);\r\n                } else {\r\n                    console.error('Failed to fetch conversations:', await res.text());\r\n                }\r\n            } catch (error) {\r\n                console.error('Error fetching conversations:', error);\r\n            }\r\n        };\r\n\r\n        fetchConversations();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        const fetchUsers = async () => {\r\n            try {\r\n                const res = await fetch(`http://localhost:8000/api/users/${user?.id}`, {\r\n                    method: 'GET',\r\n                    headers: {\r\n                        'Content-Type': 'application/json',\r\n                    }\r\n                });\r\n                if (res.ok) {\r\n                    const resData = await res.json();\r\n                    setUsers(resData);\r\n                } else {\r\n                    console.error('Failed to fetch users:', await res.text());\r\n                }\r\n            } catch (error) {\r\n                console.error('Error fetching users:', error);\r\n            }\r\n        };\r\n\r\n        fetchUsers();\r\n    }, [user?.id]);\r\n\r\n    const fetchMessages = async (conversationId, receiver) => {\r\n        try {\r\n            const res = await fetch(`http://localhost:8000/api/message/${conversationId}?senderId=${user?.id}&&receiverId=${receiver?.receiverId}`, {\r\n                method: 'GET',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                }\r\n            });\r\n            if (res.ok) {\r\n                const resData = await res.json();\r\n                setMessages(resData);\r\n            } else {\r\n                console.error('Failed to fetch messages:', await res.text());\r\n            }\r\n        } catch (error) {\r\n            console.error('Error fetching messages:', error);\r\n        }\r\n    };\r\n\r\n    const sendMessage = async () => {\r\n        try {\r\n            socket?.emit('sendMessage', {\r\n                senderId: user?.id,\r\n                receiverId: messages?.receiver?.receiverId,\r\n                message,\r\n                conversationId: messages?.conversationId\r\n            });\r\n\r\n            const res = await fetch(`http://localhost:8000/api/message`, {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify({\r\n                    conversationId: messages?.conversationId,\r\n                    senderId: user?.id,\r\n                    message,\r\n                    receiverId: messages?.receiver?.receiverId\r\n                })\r\n            });\r\n\r\n            if (res.ok) {\r\n                setMessage(''); // Clear message input on successful send\r\n            } else {\r\n                console.error('Failed to send message:', await res.text());\r\n            }\r\n        } catch (error) {\r\n            console.error('Error sending message:', error);\r\n        }\r\n    };\r\n\r\n    const handleLogout = async () => {\r\n        try {\r\n            const token = localStorage.getItem('user:token');\r\n            const response = await fetch('http://localhost:8000/api/logout', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'Authorization': `Bearer ${token}`\r\n                }\r\n            });\r\n            if (response.ok) {\r\n                localStorage.removeItem('user:token');\r\n                window.location.href = '/users/sign_in';\r\n            } else {\r\n                console.log('Logout failed:', await response.text());\r\n            }\r\n        } catch (error) {\r\n            console.error('Logout error:', error);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className='w-screen flex'>\r\n            <div className='w-[25%] h-screen bg-secondary overflow-scroll'>\r\n                <div className='flex items-center my-8 mx-14'>\r\n                    <div><img src={chat} width={75} height={75} className='border border-primary p-[2px] rounded-full' /></div>\r\n                    <div className='ml-8'>\r\n                        <h3 className='text-2xl'>{user?.fullName}</h3>\r\n                        <p className='text-lg font-light'>My Account</p>\r\n                    </div>\r\n                </div>\r\n                <div className='flex justify-center my-8'>\r\n                    <Button onClick={handleLogout}>Logout</Button>\r\n                </div>\r\n                <hr />\r\n                <div className='mx-14 mt-10'>\r\n                    <div className='text-primary text-lg'>Messages</div>\r\n                    <div>\r\n                        {\r\n                            conversations.length > 0 ?\r\n                                conversations.map(({ conversationId, user }) => (\r\n                                    <div key={conversationId} className='flex items-center py-8 border-b border-b-gray-300'>\r\n                                        <div className='cursor-pointer flex items-center' onClick={() => fetchMessages(conversationId, user)}>\r\n                                            <div><img src={chat} className=\"w-[60px] h-[60px] rounded-full p-[2px] border border-primary\" /></div>\r\n                                            <div className='ml-6'>\r\n                                                <h3 className='text-lg font-semibold'>{user?.fullName}</h3>\r\n                                                <p className='text-sm font-light text-gray-600'>{user?.email}</p>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                )) : <div className='text-center text-lg font-semibold mt-24'>No Conversations</div>\r\n                        }\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div className='w-[50%] h-screen bg-white flex flex-col items-center'>\r\n                {\r\n                    messages?.receiver?.fullName &&\r\n                    <div className='w-[75%] bg-secondary h-[80px] my-14 rounded-full flex items-center px-14 py-2'>\r\n                        <div><img src={chat} width={60} height={60} className=\"rounded-full\" /></div>\r\n                        <div className='ml-6 mr-auto'>\r\n                            <h3 className='text-lg'>{messages?.receiver?.fullName}</h3>\r\n                            <p className='text-sm font-light text-gray-600'>{messages?.receiver?.email}</p>\r\n                        </div>\r\n                    </div>\r\n                }\r\n                <div className='h-[75%] w-full overflow-scroll shadow-sm'>\r\n                    <div className='p-14'>\r\n                        {\r\n                            messages?.length > 0 ?\r\n                                messages.map(({ message, user: { id } = {} }, index) => (\r\n                                    <div key={index} className={`max-w-[40%] rounded-b-xl p-4 mb-6 ${id === user?.id ? 'bg-primary text-white rounded-tl-xl ml-auto' : 'bg-secondary rounded-tr-xl'} `}>{message}</div>\r\n                                )) : <div className='text-center text-lg font-semibold mt-24'>No Messages or No Conversation Selected</div>\r\n                        }\r\n                    </div>\r\n                    <div ref={messageRef}></div>\r\n                </div>\r\n                {\r\n                    messages?.receiver?.fullName ?\r\n                    <div className='p-14 w-full flex items-center'>\r\n                        <Input placeholder='Type a message...' value={message} onChange={(e) => setMessage(e.target.value)} className='w-[75%]' inputClassName='p-4 border-0 shadow-md rounded-full bg-light focus:ring-0 focus:border-0 outline-none' />\r\n                        <div className={`ml-4 p-2 cursor-pointer bg-light rounded-full ${!message && 'pointer-events-none'}`} onClick={sendMessage}>\r\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon icon-tabler icon-tabler-send\" width=\"30\" height=\"30\" viewBox=\"0 0 24 24\" strokeWidth=\"1.5\" stroke=\"#2c3e50\" fill=\"none\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                                <path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" />\r\n                                <line x1=\"10\" y1=\"14\" x2=\"21\" y2=\"3\" />\r\n                                <path d=\"M21 3l-6.5 18a0.55 .55 0 0 1 -1.1 0l-3.5 -9.5h-7\" />\r\n                            </svg>\r\n                        </div>\r\n                    </div> : <div className={`ml-4 p-2 cursor-pointer bg-light rounded-full ${!message && 'pointer-events-none'}`}>\r\n                        \r\n                    </div>\r\n                }\r\n\r\n                {\r\n                    !messages?.receiver?.fullName &&\r\n                    <div className='p-14 w-full flex items-center justify-center'>\r\n                        <p className='text-lg text-gray-600'>Select a conversation to start messaging</p>\r\n                    </div>\r\n                }\r\n            </div>\r\n\r\n            <div className='w-[25%] h-screen bg-light px-8 py-16 overflow-scroll'>\r\n                <div className='text-primary text-lg'>People</div>\r\n                <div>\r\n                    {\r\n                        users.length > 0 ?\r\n                            users.map(({ userId, user }) => (\r\n                                <div key={userId} className='flex items-center py-8 border-b border-b-gray-300'>\r\n                                    <div className='cursor-pointer flex items-center' onClick={() => fetchMessages('new', user)}>\r\n                                        <div><img src={chat} className=\"w-[60px] h-[60px] rounded-full p-[2px] border border-primary\" /></div>\r\n                                        <div className='ml-6'>\r\n                                            <h3 className='text-lg font-semibold'>{user?.fullName}</h3>\r\n                                            <p className='text-sm font-light text-gray-600'>{user?.email}</p>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            )) : <div className='text-center text-lg font-semibold mt-24'>No Conversations</div>\r\n                    }\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Dashboard;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}